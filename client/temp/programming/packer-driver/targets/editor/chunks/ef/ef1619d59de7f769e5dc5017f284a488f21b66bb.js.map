{"version":3,"sources":["file:///Users/even/workspace/github/yilinershi/pitaya_cocos_demo/client/assets/scripts/logic/login/LoginView.ts"],"names":["Button","Component","director","EditBox","find","_decorator","LoginController","ccclass","property","LoginView","_editBoxAccount","_editBoxPassword","_buttonRegister","_buttonLogin","onLoad","node","getComponent","start","refreshAccountAndPassword","Start","onEnable","on","buttonLoginClick","buttonRegisterClick","onDisable","off","string","localStorage","getItem","setItem","OnLogin","OnConnectorAuth","loadScene","err","scene","OnRegister"],"mappings":"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","sourcesContent":["import { Button, Component, director, EditBox, find, Label, _decorator } from \"cc\";\nimport { Pitaya } from \"../../net/pitaya/Pitaya\";\nimport { LoginController } from \"./LoginController\";\n\nconst { ccclass, property } = _decorator;\n\n\n/**\n * 客户端从login开始，整个客户端没用什么框架，写得比较简单\n */\n@ccclass(\"LoginView\")\nexport class LoginView extends Component {\n\n    private _editBoxAccount: EditBox = new EditBox();\n    private _editBoxPassword: EditBox = new EditBox();\n    private _buttonRegister: Button = new Button();\n    private _buttonLogin: Button = new Button();\n\n    public onLoad() {\n        this._editBoxAccount = find(\"EditBox_Account\", this.node)?.getComponent(EditBox) as EditBox;\n        this._editBoxPassword = find(\"EditBox_Password\", this.node)?.getComponent(EditBox) as EditBox;\n        this._buttonRegister = find(\"Button_Register\", this.node)?.getComponent(Button) as Button;\n        this._buttonLogin = find(\"Button_Login\", this.node)?.getComponent(Button) as Button;\n    }\n\n    public async start() {\n        this.refreshAccountAndPassword()\n        await LoginController.Start()\n    }\n\n    public onEnable() {\n        this._buttonLogin?.node.on('click', () => { this.buttonLoginClick() })\n        this._buttonRegister?.node.on('click', () => this.buttonRegisterClick())\n    }\n\n    public onDisable() {\n        this._buttonLogin?.node.off('click', () => { this.buttonLoginClick() })\n        this._buttonRegister?.node.off('click', () => this.buttonRegisterClick())\n    }\n\n    private refreshAccountAndPassword() {\n        this._editBoxAccount.string = \"\"\n        this._editBoxPassword.string = \"\"\n        if (localStorage.getItem(\"account\") != null) {\n            this._editBoxAccount.string = localStorage.getItem(\"account\") as string;\n        }\n        if (localStorage.getItem(\"password\") != null) {\n            this._editBoxPassword.string = localStorage.getItem(\"password\") as string;\n        }\n    }\n\n    private async buttonLoginClick() {\n        localStorage.setItem(\"account\", this._editBoxAccount.string)\n        localStorage.setItem(\"password\", this._editBoxPassword.string)\n        await LoginController.OnLogin(this._editBoxAccount.string, this._editBoxPassword.string)\n        await LoginController.OnConnectorAuth()\n        director.loadScene(\"lobby\", (err, scene) => {\n            if (err != null) {\n                return\n            }\n        })\n    }\n\n    private async buttonRegisterClick() {\n        localStorage.setItem(\"account\", this._editBoxAccount.string)\n        localStorage.setItem(\"password\", this._editBoxPassword.string)\n        await LoginController.OnRegister(this._editBoxAccount.string, this._editBoxPassword.string)\n\n    }\n\n}"]}